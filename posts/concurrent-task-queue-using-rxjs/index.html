<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Concurrent task queue using RxJS" /><meta property="og:locale" content="en" /><meta name="description" content="So far so good Web applications have always needed to run different tasks based on events triggered by the end-user. Long ago, when browsers were more restricted, these applications had to run tasks one by one in most cases." /><meta property="og:description" content="So far so good Web applications have always needed to run different tasks based on events triggered by the end-user. Long ago, when browsers were more restricted, these applications had to run tasks one by one in most cases." /><link rel="canonical" href="https://jcarloslr10.github.io/posts/concurrent-task-queue-using-rxjs/" /><meta property="og:url" content="https://jcarloslr10.github.io/posts/concurrent-task-queue-using-rxjs/" /><meta property="og:site_name" content="Juan Carlos López" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-15T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Concurrent task queue using RxJS" /><meta name="twitter:site" content="@jcarloslr10" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-15T00:00:00+02:00","datePublished":"2022-05-15T00:00:00+02:00","description":"So far so good Web applications have always needed to run different tasks based on events triggered by the end-user. Long ago, when browsers were more restricted, these applications had to run tasks one by one in most cases.","headline":"Concurrent task queue using RxJS","mainEntityOfPage":{"@type":"WebPage","@id":"https://jcarloslr10.github.io/posts/concurrent-task-queue-using-rxjs/"},"url":"https://jcarloslr10.github.io/posts/concurrent-task-queue-using-rxjs/"}</script><title>Concurrent task queue using RxJS | Juan Carlos López</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Juan Carlos López"><meta name="application-name" content="Juan Carlos López"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><meta name="google-site-verification" content="RYfhY0x_-nuFQ4N7CKDAm3oWUsySKvxoIUO-txMspQo" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://avatars.githubusercontent.com/u/15978818?v=4 " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Juan Carlos López</a></div><div class="site-subtitle font-italic">Software engineer @ Plain Concepts</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/jcarloslr10" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/jcarloslr10" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tmac.juancar.24','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Concurrent task queue using RxJS</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Concurrent task queue using RxJS</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/jcarloslr10">Juan Carlos López</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652565600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-15 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1743 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h2 id="so-far-so-good"><span class="mr-2">So far so good</span><a href="#so-far-so-good" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>Web applications have always needed to run different tasks based on events triggered by the end-user. Long ago, when browsers were more restricted, these applications had to run tasks one by one in most cases.</p><p>Currently, browsers have more capabilities which allow more complex and demanding scenarios, such as the execution of concurrent tasks from a web application.</p><p>With the rise of <strong>SPAs</strong> (Single-Page Applications), some Javascript libraries or frameworks favor the use of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><strong>Promises</strong></a> while others favor <a href="https://rxjs.dev/guide/observable" target="_blank"><strong>Observables</strong></a>. With either of them, it is possible to successfully manage the execution of tasks concurrently, either by using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all" target="_blank"><strong>Promise.all</strong></a> in the case of <strong>Promises</strong> or by using combination operators such as <a href="https://rxjs.dev/api/index/function/forkJoin" target="_blank"><strong>forkJoin</strong></a> in the case of <strong>Observables</strong>. All of these things make life easier, although it is not enough for some scenarios.</p><p>Let’s imagine a SPA to store and tag videos where the end-user can upload videos while navigating through the different screens performing actions that request and load data. This specific case will be somewhat troublesome since all requests are <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest" target="_blank"><strong>XHR</strong></a> and, as is known, current browsers still have limitations in this regard.</p><p>If the end-user of this imaginary application needs to upload many videos in the background while still browsing it, we need some way to limit the number request running in the background to free up some connections to continue browsing, otherwise requests will start to be blocked once the limit set by the browser is exceeded. If you want to learn more about browser restrictions, click <a href="https://www.linkedin.com/pulse/why-does-your-browser-limit-number-concurrent-ishwar-rimal/" target="_blank">here</a>.</p><p><strong>RxJS</strong> to the rescue! 🦸</p><h2 id="how-the-hell-do-we-do-this"><span class="mr-2">How the hell do we do this?</span><a href="#how-the-hell-do-we-do-this" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><h3 id="context"><span class="mr-2">Context</span><a href="#context" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Since we are talking about uploading videos, we are going to represent the upload process by means of an entity called <strong>process</strong> that has a unique <code class="language-plaintext highlighter-rouge">id</code>, a <code class="language-plaintext highlighter-rouge">status</code> (<code class="language-plaintext highlighter-rouge">pending</code>, <code class="language-plaintext highlighter-rouge">in progress</code>, <code class="language-plaintext highlighter-rouge">completed</code> and <code class="language-plaintext highlighter-rouge">failed</code>), a <code class="language-plaintext highlighter-rouge">percentage</code> of progress (from <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">100</code>) and the metadata and content of the video in a <code class="language-plaintext highlighter-rouge">data</code> property.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="p">{</span>
  <span class="nl">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nx">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">pending</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">percentage</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">data</span><span class="p">:</span> <span class="p">{...}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="concepts"><span class="mr-2">Concepts</span><a href="#concepts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Before we get down to business, it’s important to know what a <a href="https://rxjs.dev/guide/subject" target="_blank"><strong>Subject</strong></a> is in the RxJS world.</p><p>In a nutshell, a <strong>Subject</strong> is a special type of <strong>Observable</strong> that allows multicasting unlike plain Observables that allow unicasting, but it also acts as an <strong>Observer</strong> allowing values to be sent through the <strong>Subject</strong> itself.</p><p>This piece of <strong>RxJS</strong> guides the rest of the lines in this post.</p><h3 id="code"><span class="mr-2">Code</span><a href="#code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Let’s to discover the code step by step for a better understanding.</p><p>First, we need a <strong>Subject</strong> that acts as the source where we are going to feed the new processes that have to be executed. For this purpose there is <code class="language-plaintext highlighter-rouge">addProcess$</code> which receives raw processes represented by the <code class="language-plaintext highlighter-rouge">id</code> and <code class="language-plaintext highlighter-rouge">data</code> properties mentioned above.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">addProcess$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Subject</span><span class="p">();</span>
</pre></table></code></div></div><p>Every time a new raw proccess is fed into the Subject, it goes trough a number of different status depending on the state of the concurrent queue that we are trying to build:</p><ol><li>A new process comes in: the process remains with <code class="language-plaintext highlighter-rouge">status</code> equal <code class="language-plaintext highlighter-rouge">pending</code> and <code class="language-plaintext highlighter-rouge">percentage</code> equal to <code class="language-plaintext highlighter-rouge">0</code>.<li>A pending process is scheduled for execution: the process changes the <code class="language-plaintext highlighter-rouge">status</code> to <code class="language-plaintext highlighter-rouge">in progress</code> and <code class="language-plaintext highlighter-rouge">percentage</code> equal to the progress of the task, in this case, the HTTP request.<li>A running process completes or fails: the process changes the <code class="language-plaintext highlighter-rouge">status</code> to <code class="language-plaintext highlighter-rouge">completed</code> or <code class="language-plaintext highlighter-rouge">failed</code> depending on how it ends.</ol><p>Keeping this in mind, we need a way to map the raw model to a meaninful model that allow us to represent that world.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">addProcess$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Subject</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">processQueue$</span> <span class="o">=</span> <span class="nx">addProcess$</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
    <span class="nx">connect</span><span class="p">(</span><span class="nx">subject$</span> <span class="o">=&gt;</span>
      <span class="nx">subject$</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
        <span class="nx">mergeMap</span><span class="p">((</span><span class="nx">process</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">of</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">pending</span><span class="dl">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
        <span class="p">})</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">process</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">})</span>

<span class="kd">const</span> <span class="nx">updateProcess</span> <span class="o">=</span> <span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">percentage</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="p">...</span><span class="nx">process</span><span class="p">,</span>
  <span class="nx">status</span><span class="p">,</span>
  <span class="nx">percentage</span><span class="p">,</span>
<span class="p">});</span>
</pre></table></code></div></div><p>The <strong>connect</strong> operator allows multicasting of the source, so it shares the single subscription created with other subscribers, which is efficient in terms of subscription management and, on the other hand, all the subscribers that may exist would receive the same data.</p><p>It’s also necessary the use of <strong>mergeMap</strong> operator to project the value of the source to end up mapping to a model that represents the state mentioned above in the first point.</p><blockquote><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />A new process comes in: the process remains with <code class="language-plaintext highlighter-rouge">status</code> equal <code class="language-plaintext highlighter-rouge">pending</code> and <code class="language-plaintext highlighter-rouge">percentage</code> equal to <code class="language-plaintext highlighter-rouge">0</code>.<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />A pending process is scheduled for execution: the process changes the <code class="language-plaintext highlighter-rouge">status</code> to <code class="language-plaintext highlighter-rouge">in progress</code> and <code class="language-plaintext highlighter-rouge">percentage</code> equal to the progress of the task, in this case, the HTTP request.<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />A running process completes or fails: the process changes the <code class="language-plaintext highlighter-rouge">status</code> to <code class="language-plaintext highlighter-rouge">completed</code> or <code class="language-plaintext highlighter-rouge">failed</code> depending on how it ends.</ul></blockquote><p>To address the problem of scheduling the execution processes, let’s take a look at the following code snippet 🤓:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">maxConcurrency</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">addProcess$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Subject</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">processQueue$</span> <span class="o">=</span> <span class="nx">addProcess$</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
    <span class="nx">connect</span><span class="p">(</span><span class="nx">subject$</span> <span class="o">=&gt;</span>
      <span class="nx">merge</span><span class="p">(</span>
        <span class="nx">subject$</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
          <span class="nx">mergeMap</span><span class="p">((</span><span class="nx">process</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">of</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">pending</span><span class="dl">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
              <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
                <span class="nx">observeOn</span><span class="p">(</span><span class="nx">asyncScheduler</span><span class="p">),</span>
                <span class="nx">takeUntil</span><span class="p">(</span><span class="nx">merge</span><span class="p">(</span><span class="nx">subject$</span><span class="p">))</span>
              <span class="p">);</span>
          <span class="p">})</span>
        <span class="p">),</span>
        <span class="nx">subject$</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
          <span class="nx">mergeMap</span><span class="p">((</span><span class="nx">process</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">fakeHttpRequest</span><span class="p">(</span><span class="nx">process</span><span class="p">)</span>
              <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
                <span class="nx">startWith</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                <span class="nx">endWith</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">completed</span><span class="dl">'</span><span class="p">,</span> <span class="mi">100</span><span class="p">)),</span>
                <span class="nx">catchError</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">of</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">failed</span><span class="dl">'</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">percentage</span><span class="p">))),</span>
                <span class="nx">scan</span><span class="p">((</span><span class="nx">accum</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span> <span class="p">...</span><span class="nx">accum</span><span class="p">,</span> <span class="p">...</span><span class="nx">value</span> <span class="p">}),</span> <span class="p">{}),</span>
              <span class="p">)</span>
          <span class="p">},</span> <span class="nx">maxConcurrency</span><span class="p">)</span>
        <span class="p">)</span>
      <span class="p">).</span><span class="nx">pipe</span><span class="p">(</span>
        <span class="nx">scan</span><span class="p">((</span><span class="nx">accum</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span> <span class="p">...</span><span class="nx">accum</span><span class="p">,</span> <span class="p">[</span><span class="nx">value</span><span class="p">.</span><span class="nx">id</span><span class="p">]:</span> <span class="nx">value</span> <span class="p">}),</span> <span class="p">{}),</span>
        <span class="nx">map</span><span class="p">(</span><span class="nx">obj</span> <span class="o">=&gt;</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">processes</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">})</span>

<span class="kd">const</span> <span class="nx">updateProcess</span> <span class="o">=</span> <span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">percentage</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="p">...</span><span class="nx">process</span><span class="p">,</span>
  <span class="nx">status</span><span class="p">,</span>
  <span class="nx">percentage</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">fakeHttpDelay</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">fakeHttpRequest</span> <span class="o">=</span> <span class="p">(</span><span class="nx">process</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">Observable</span><span class="p">(</span><span class="nx">subscriber</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">subscriber</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">25</span><span class="p">));</span>
  <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">subscriber</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">50</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
      <span class="nx">subscriber</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Connection error!</span><span class="dl">'</span><span class="p">));</span>

    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">subscriber</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">75</span><span class="p">));</span>
      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">subscriber</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">99</span><span class="p">));</span>
        <span class="nx">subscriber</span><span class="p">.</span><span class="nx">complete</span><span class="p">();</span>
      <span class="p">},</span> <span class="nx">fakeHttpDelay</span><span class="p">);</span>
    <span class="p">},</span> <span class="nx">fakeHttpDelay</span><span class="p">);</span>
  <span class="p">},</span> <span class="nx">fakeHttpDelay</span><span class="p">);</span>
<span class="p">});</span>
</pre></table></code></div></div><p>The first new thing we see is that just below the <strong>connect</strong> operator, there is a <strong>merge</strong> operator that allows us to declare another <strong>Observable</strong> to manage the scheduling of process executions.</p><p>The second <strong>Observable</strong> also uses a <strong>mergeMap</strong> operator to project the value of the source and subsequently fires an HTTP request (<em>fakeHttpRequest</em>) that simulates the process of uploading a video. Note that <strong>mergeMap</strong> receives the <code class="language-plaintext highlighter-rouge">maxConcurrency</code> variable as its second parameter, which establishes the maximum number of input <strong>Observables</strong> being subscribed to concurrently. This value sets how many upload processes are executed concurrently, leaving free connections to continue browsing.</p><p>As for the operators within the <code class="language-plaintext highlighter-rouge">pipe</code> block:</p><ul><li><strong>startWith</strong> sets the state at the moment of subscription.<li><strong>endWith</strong> sets the state immediately after the source completes.<li><strong>catchError</strong> sets the state when an error occurs.<li><strong>scan</strong> allows managing the state by acummulating or merging intermediate states.</ul><p>Before finishing, it’s worth mentioning the pair of statements added to the first <strong>Observable</strong> inside the operator <strong>merge</strong>:</p><ul><li><strong>observeOn(asyncScheduler)</strong> defer the emission of the data from the <strong>Observable</strong> to the JS event loop for better performance.<li><strong>takeUntil(merge(subject$))</strong> unsubscribe the <strong>Observable</strong> once it emits a value. The internal <strong>merge</strong> is a trick to make it emit once, since <code class="language-plaintext highlighter-rouge">subject$</code> has already emitted a value when it got here.</ul><p>The above describes the states previously mentioned in the second and third points.</p><blockquote><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />A new process comes in: the process remains with <code class="language-plaintext highlighter-rouge">status</code> equal <code class="language-plaintext highlighter-rouge">pending</code> and <code class="language-plaintext highlighter-rouge">percentage</code> equal to <code class="language-plaintext highlighter-rouge">0</code>.<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />A pending process is scheduled for execution: the process changes the <code class="language-plaintext highlighter-rouge">status</code> to <code class="language-plaintext highlighter-rouge">in progress</code> and <code class="language-plaintext highlighter-rouge">percentage</code> equal to the progress of the task, in this case, the HTTP request.<li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />A running process completes or fails: the process changes the <code class="language-plaintext highlighter-rouge">status</code> to <code class="language-plaintext highlighter-rouge">completed</code> or <code class="language-plaintext highlighter-rouge">failed</code> depending on how it ends.</ul></blockquote><h3 id="bonus-code"><span class="mr-2">Bonus code</span><a href="#bonus-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>What if you want to drop some scheduled process on the queue? There goes a solution based on introducing a new Subject where the process to be discarded is notified. ✨</p><p>In a few words, merging what we already had with that new Subject and using a scan operator, we manage to discard those processes that are in <code class="language-plaintext highlighter-rouge">processQueue$</code> when they come through <code class="language-plaintext highlighter-rouge">dropProcess$</code>.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">maxConcurrency</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">addProcess$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Subject</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">dropProcess$</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Subject</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">processQueue$</span> <span class="o">=</span> <span class="nx">addProcess$</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
    <span class="nx">connect</span><span class="p">(</span><span class="nx">subject$</span> <span class="o">=&gt;</span>
      <span class="nx">merge</span><span class="p">(</span>
        <span class="nx">subject$</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
          <span class="nx">mergeMap</span><span class="p">((</span><span class="nx">process</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">of</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">pending</span><span class="dl">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
              <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
                <span class="nx">observeOn</span><span class="p">(</span><span class="nx">asyncScheduler</span><span class="p">),</span>
                <span class="nx">takeUntil</span><span class="p">(</span><span class="nx">merge</span><span class="p">(</span><span class="nx">subject$</span><span class="p">))</span>
              <span class="p">);</span>
          <span class="p">})</span>
        <span class="p">),</span>
        <span class="nx">subject$</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
          <span class="nx">mergeMap</span><span class="p">((</span><span class="nx">process</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">fakeHttpRequest</span><span class="p">(</span><span class="nx">process</span><span class="p">)</span>
              <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
                <span class="nx">startWith</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                <span class="nx">endWith</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">completed</span><span class="dl">'</span><span class="p">,</span> <span class="mi">100</span><span class="p">)),</span>
                <span class="nx">catchError</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">of</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">failed</span><span class="dl">'</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">percentage</span><span class="p">))),</span>
                <span class="nx">scan</span><span class="p">((</span><span class="nx">accum</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span> <span class="p">...</span><span class="nx">accum</span><span class="p">,</span> <span class="p">...</span><span class="nx">value</span> <span class="p">}),</span> <span class="p">{}),</span>
                <span class="nx">takeUntil</span><span class="p">(</span>
                  <span class="nx">dropProcess$</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
                    <span class="nx">filter</span><span class="p">(</span><span class="nx">p</span> <span class="o">=&gt;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">process</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
                  <span class="p">)),</span>
              <span class="p">)</span>
          <span class="p">},</span> <span class="nx">maxConcurrency</span><span class="p">)</span>
        <span class="p">)</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">);</span>

<span class="kd">const</span> <span class="nx">droppableProcessQueue$</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">processQueue$</span><span class="p">,</span> <span class="nx">dropProcess$</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
    <span class="nx">scan</span><span class="p">((</span><span class="nx">accum</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">dropped</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="p">{</span> <span class="p">[</span><span class="nx">value</span><span class="p">.</span><span class="nx">id</span><span class="p">]:</span> <span class="nx">_</span><span class="p">,</span> <span class="p">...</span><span class="nx">rest</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">accum</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">rest</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="p">{</span> <span class="p">...</span><span class="nx">accum</span><span class="p">,</span> <span class="p">[</span><span class="nx">value</span><span class="p">.</span><span class="nx">id</span><span class="p">]:</span> <span class="nx">value</span> <span class="p">};</span>
    <span class="p">},</span> <span class="p">{}),</span>
    <span class="nx">map</span><span class="p">(</span><span class="nx">obj</span> <span class="o">=&gt;</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span>
  <span class="p">);</span>

<span class="nx">droppableProcessQueue$</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">processes</span> <span class="o">=&gt;</span> <span class="p">{...});</span>

<span class="kd">const</span> <span class="nx">updateProcess</span> <span class="o">=</span> <span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">percentage</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="p">...</span><span class="nx">process</span><span class="p">,</span>
  <span class="nx">status</span><span class="p">,</span>
  <span class="nx">percentage</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">fakeHttpDelay</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">fakeHttpRequest</span> <span class="o">=</span> <span class="p">(</span><span class="nx">process</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">Observable</span><span class="p">(</span><span class="nx">subscriber</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">subscriber</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">25</span><span class="p">));</span>
  <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">subscriber</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">50</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
      <span class="nx">subscriber</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Connection error!</span><span class="dl">'</span><span class="p">));</span>

    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">subscriber</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">75</span><span class="p">));</span>
      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">subscriber</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">updateProcess</span><span class="p">(</span><span class="nx">process</span><span class="p">,</span> <span class="dl">'</span><span class="s1">in progress</span><span class="dl">'</span><span class="p">,</span> <span class="mi">99</span><span class="p">));</span>
        <span class="nx">subscriber</span><span class="p">.</span><span class="nx">complete</span><span class="p">();</span>
      <span class="p">},</span> <span class="nx">fakeHttpDelay</span><span class="p">);</span>
    <span class="p">},</span> <span class="nx">fakeHttpDelay</span><span class="p">);</span>
  <span class="p">},</span> <span class="nx">fakeHttpDelay</span><span class="p">);</span>
<span class="p">});</span>
</pre></table></code></div></div><h3 id="sample-application"><span class="mr-2">Sample application</span><a href="#sample-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Below is a screenshot of an application that implements all the code described in the post for testing purposes.</p><p><img data-src="/assets/img/posts/concurrent-task-queue-using-rxjs/sample-app.jpg" alt="app" data-proofer-ignore> <em>Sample application</em></p><p>The full source code of the sample application is <a href="https://github.com/jcarloslr10/concurrent-task-queue-using-rxjs" target="_blank"><strong>here</strong></a>.</p><h2 id="conclusions"><span class="mr-2">Conclusions</span><a href="#conclusions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>To wrap this up:</p><ul><li><p>The power of the RxJS library and all its components and operators is evident, it really provides a range of fascinating options.</p><li><p>It becomes clear that in many scenarios RxJS is as powerful as it’s complex. Sometimes, a deep knowledge is needed when implementing this type of solutions.</p></ul><p>I hope you like it and it clarifies a lot of the black magic that RxJS has.</p><p>See you! 😉</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/frontend/'>Frontend</a>, <a href='/categories/rxjs/'>RxJS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/rxjs/" class="post-tag no-text-decoration" >rxjs</a> <a href="/tags/queue/" class="post-tag no-text-decoration" >queue</a> <a href="/tags/concurrency/" class="post-tag no-text-decoration" >concurrency</a> <a href="/tags/task/" class="post-tag no-text-decoration" >task</a> <a href="/tags/observable/" class="post-tag no-text-decoration" >observable</a> <a href="/tags/observer/" class="post-tag no-text-decoration" >observer</a> <a href="/tags/subject/" class="post-tag no-text-decoration" >subject</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Concurrent task queue using RxJS - Juan Carlos López&amp;url=https://jcarloslr10.github.io/posts/concurrent-task-queue-using-rxjs/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Concurrent task queue using RxJS - Juan Carlos López&amp;u=https://jcarloslr10.github.io/posts/concurrent-task-queue-using-rxjs/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://jcarloslr10.github.io/posts/concurrent-task-queue-using-rxjs/&amp;text=Concurrent task queue using RxJS - Juan Carlos López" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/effective-strategies-for-dealing-with-regular-expression-queries-in-mongodb/">Effective strategies for dealing with regular expression queries in MongoDB</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/concurrency/">concurrency</a> <a class="post-tag" href="/tags/database/">database</a> <a class="post-tag" href="/tags/index/">index</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/observable/">observable</a> <a class="post-tag" href="/tags/observer/">observer</a> <a class="post-tag" href="/tags/performance/">performance</a> <a class="post-tag" href="/tags/queue/">queue</a> <a class="post-tag" href="/tags/regex/">regex</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/effective-strategies-for-dealing-with-regular-expression-queries-in-mongodb/"><div class="card-body"> <em class="timeago small" data-ts="1651442400" > 2022-05-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Effective strategies for dealing with regular expression queries in MongoDB</h3><div class="text-muted small"><p> Thanks to my teammate Daniel Perdomo for his help. I couldn’t have done it without you. 🙏 The Millenium Problem Some of us have worked building applications where, at some point, they need t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/effective-strategies-for-dealing-with-regular-expression-queries-in-mongodb/" class="btn btn-outline-primary" prompt="Older"><p>Effective strategies for dealing with regular expression queries in MongoDB</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "jcarloslr10/jcarloslr10.github.io", "data-repo-id": "R_kgDOHPdYDQ", "data-category": "Comments", "data-category-id": "DIC_kwDOHPdYDc4CO5Q8", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/jcarloslr10">Juan Carlos López</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/concurrency/">concurrency</a> <a class="post-tag" href="/tags/database/">database</a> <a class="post-tag" href="/tags/index/">index</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/observable/">observable</a> <a class="post-tag" href="/tags/observer/">observer</a> <a class="post-tag" href="/tags/performance/">performance</a> <a class="post-tag" href="/tags/queue/">queue</a> <a class="post-tag" href="/tags/regex/">regex</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-N2KTFCE5LB"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-N2KTFCE5LB'); }); </script>
